# Task: PacMan

Solve:

1. Смотрим, что к нас в цикле main и можно заметить функцию, которая вызывается странным образом, не влияя на сам игровой движок и на саму игру

![](assets/1.png)

2. Вот как это, собственно, выглядит в псевдокоде:

![](assets/2.png)

3. Перейдя в эту функцию, можно увидеть антиоткладочные проверки 

![](assets/3.png)

4. Но можно заметить, что какие-то два странных числа кладутся в ячейку памяти

![](assets/4.png)

![](assets/5.png)

5. Пропатчим данный вызов и попробуем скипнуть проверку на дебаг

![](assets/6.png)

6. Далее вернемся к тем ячейкам памяти и посмотрим, где они вызываются еще. Нажодим их вызов в функции 5050

![](assets/7.png)

7. Далее пробуем найти функцию, в которой как раз происходит игровая логика. Глянем функцию 57Е0

![](assets/8.png)

8. Анализируя функцию, натыкаемся на проверку, при прохождения которой заканчивается работа программы, но перед этим вызывается функция, глянем, что там

![](assets/9.png)

![](assets/10.png)

9. Также можно найти эту функцию по стрингам

![](assets/11.png)

10. Видим ту функцию 5050 и, осмотрев ее поподробнее, понимаем, что, скорее всего, в ней происходид расшифровка флага

![](assets/12.png)

11. Поставим брейкпонинт перед проверкой победы

![](assets/13.png)

12. Начнем дебаг, первым делом патчим мусор, который у нас остался на месте вызова функции, а также скипаем проверку победы и переходим к функции расшифровки флага

![](assets/14.png)

![](assets/15.png)

12. Доходим до тех переменных, в которых должны класться ключи и меняем в памяти нули на нужные нам значения 

![](assets/16.png)

![](assets/17.png)

12. Дадее доходим до куска, где данные передаются в переменную и можем увидеть в буфере расшифрованный флаг

![](assets/18.png)

![](assets/19.png)

![](assets/20.png)


Flag: `EclipseCTF{ant!_ch3at_I$_d3feat3d}`
